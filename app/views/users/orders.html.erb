<h2>Orders</h2>

<% @order_statuses.each do |order_status| %>
  <%= link_to "#{order_status.capitalize}", account_orders_path(status: order_status) %>
<% end %>
<%= link_to "All", account_orders_path(status: 'all') %>

<% if @order_items.empty? %>
  <p>You have no orders.</p>
<% else %>
  <table>
    <thead>
      <tr>
        <th>Order</th>
        <th>Date</th>
        <th>Product</th>
        <th>Price</th>
        <th>Quantity</th>
        <th>Subtotal</th>
        <th>Item Status</th>
        <th>Order Status</th>
      </tr>
    </thead>
    <tbody>
      <% @order_items.each do |order_item| %>
        <tr>
          <td><%= link_to(order_item.order.id, order_path(order_item.order.id)) %></td>
          <td><%= order_item.created_at %></td>
          <td><%= link_to order_item.product.name, product_path(order_item.product.id) %></td>
          <td><%= order_item.product.price %></td>
          <td><%= order_item.quantity %></td>
          <td><%= order_item.subtotal %></td>
          <td>
            <% if ['shipped', 'cancelled'].include? order_item.status %>
              <%= order_item.status.capitalize %>
            <% else %>
              <%= link_to "Mark Shipped", shipped_path(order_item.id), method: :patch %>&nbsp;&nbsp;
              <%= link_to "Cancel", cancelled_path(order_item.id), method: :patch %>
            <% end %>
          </td>
          <td><%= order_item.order.status.capitalize %></td>
        </tr>

      <% end %>
    </tbody>
  </table>
<% end %>
